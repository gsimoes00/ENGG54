//Inicialização da placa e esperas
#include "ezdsp5502.h"
//Comunicar I2C com o codec para configurar
#include "ezdsp5502_i2c.h"
//Selecionar o canal do codec na MCBSP
#include "ezdsp5502_i2cgpio.h"
//Enviar e receber dados do codec
#include "ezdsp5502_mcbsp.h"
#include "csl_mcbsp.h"
//Para utilizar os botões
#include "csl_gpio.h"

//Endereço I2C do codec
#define AIC3204_I2C_ADDR 0x18
#define TABLESIZE 1600

//Frequencias das notas
#define C 131
#define D 147
#define E 165
#define F 175
#define G 196
#define A 220
#define B 247

//Notas musicais na ordem
Int16 song[] = {F, A, B, F, A, B, E*2, D*2, B, C*2, B, G, E, D, E, G, E, F, A, B, F, A, B, E*2, D*2, B, C*2, E*2, G, E, D, E, G, E, D, E, F, G, A, B, D, E, F, C*2, D*2, E*2, D, E, F, G, A, B, B, A, C, B, D, C, E, F, E, E};

//Look-up table de seno
Int16 sinetable[1600] = {0, 129, 257, 386, 515, 643, 772, 901, 1029, 1158, 1286, 1415, 1544,1672, 1801, 1929, 2058, 2186, 2314, 2443, 2571, 2699, 2827, 2956, 3084, 3212, 3340, 3468, 3596, 3724, 3851, 3979, 4107, 4235, 4362, 4490, 4617, 4744, 4872, 4999, 5126, 5253, 5380, 5507,5634, 5760, 5887, 6014, 6140, 6266, 6393, 6519, 6645, 6771, 6897, 7022, 7148, 7274, 7399, 7524, 7650, 7775, 7900, 8024, 8149, 8274, 8398, 8522, 8647, 8771, 8895, 9018, 9142, 9265, 9389,9512, 9635, 9758, 9881, 10003, 10126, 10248, 10370, 10492, 10614, 10736, 10857, 10979, 11100, 11221, 11342, 11462, 11583, 11703, 11823, 11943, 12063, 12182, 12302, 12421, 12540, 12659, 12777, 12896, 13014, 13132, 13250, 13367, 13485, 13602, 13719, 13835, 13952, 14068, 14184, 14300, 14416, 14531, 14647, 14762, 14876, 14991, 15105, 15219, 15333, 15447, 15560, 15673, 15786, 15899, 16011, 16123, 16235, 16347, 16458, 16569, 16680, 16791, 16901, 17011, 17121, 17231,17340, 17449, 17558, 17666, 17775, 17883, 17990, 18098, 18205, 18312, 18418, 18525, 18631, 18736, 18842, 18947, 19052, 19156, 19261, 19365, 19468, 19572, 19675, 19777, 19880, 19982, 20084, 20185, 20286, 20387, 20488, 20588, 20688, 20788, 20887, 20986, 21085, 21183, 21281, 21379, 21476, 21573, 21670, 21766, 21862, 21958, 22053, 22148, 22243, 22337, 22431, 22525, 22618, 22711, 22804, 22896, 22988, 23079, 23170, 23261, 23352, 23442, 23532, 23621, 23710, 23799, 23887, 23975, 24062, 24149, 24236, 24323, 24409, 24494, 24580, 24665, 24749, 24833, 24917, 25000, 25083, 25166, 25248, 25330, 25411, 25492, 25573, 25653, 25733, 25813, 25892, 25970, 26049,26127, 26204, 26281, 26358, 26434, 26510, 26585, 26660, 26735, 26809, 26883, 26956, 27029, 27102, 27174, 27246, 27317, 27388, 27458, 27528, 27598, 27667, 27736, 27804, 27872, 27939, 28006, 28073, 28139, 28205, 28270, 28335, 28399, 28463, 28527, 28590, 28653, 28715, 28777, 28838, 28899, 28959, 29019, 29079, 29138, 29197, 29255, 29312, 29370, 29427, 29483, 29539, 29594, 29649, 29704, 29758, 29812, 29865, 29918, 29970, 30022, 30073, 30124, 30174, 30224, 30274, 30323, 30371, 30419, 30467, 30514, 30561, 30607, 30653, 30698, 30743, 30787, 30831, 30874, 30917, 30959, 31001, 31043, 31084, 31124, 31164, 31204, 31243, 31281, 31319, 31357, 31394, 31431,31467, 31503, 31538, 31572, 31607, 31640, 31674, 31706, 31739, 31770, 31802, 31832, 31863, 31892, 31922, 31951, 31979, 32007, 32034, 32061, 32087, 32113, 32138, 32163, 32188, 32211, 32235, 32258, 32280, 32302, 32323, 32344, 32365, 32384, 32404, 32423, 32441, 32459, 32476, 32493, 32510, 32525, 32541, 32556, 32570, 32584, 32597, 32610, 32623, 32634, 32646, 32657, 32667, 32677, 32686, 32695, 32703, 32711, 32718, 32725, 32732, 32737, 32743, 32748, 32752, 32756, 32759, 32762, 32764, 32766, 32767, -32768, -32768, -32768, 32767, 32766, 32764, 32762, 32759, 32756, 32752, 32748, 32743, 32737, 32732, 32725, 32718, 32711, 32703, 32695, 32686, 32677, 32667, 32657, 32646, 32634, 32623, 32610, 32597, 32584, 32570, 32556, 32541, 32525, 32510, 32493, 32476, 32459, 32441, 32423, 32404, 32384, 32365, 32344, 32323, 32302, 32280, 32258, 32235, 32211, 32188, 32163, 32138, 32113, 32087, 32061, 32034, 32007, 31979, 31951, 31922, 31892, 31863, 31832, 31802, 31770, 31739, 31706, 31674, 31640, 31607, 31572, 31538, 31503, 31467, 31431, 31394, 31357, 31319, 31281, 31243, 31204, 31164, 31124, 31084, 31043, 31001, 30959, 30917,30874, 30831, 30787, 30743, 30698, 30653, 30607, 30561, 30514, 30467, 30419, 30371, 30323, 30274, 30224, 30174, 30124, 30073, 30022, 29970, 29918, 29865, 29812, 29758, 29704, 29649, 29594, 29539, 29483, 29427, 29370, 29312, 29255, 29197, 29138, 29079, 29019, 28959, 28899, 28838, 28777, 28715, 28653, 28590, 28527, 28463, 28399, 28335, 28270, 28205, 28139, 28073, 28006, 27939, 27872, 27804, 27736, 27667, 27598, 27528, 27458, 27388, 27317, 27246, 27174, 27102, 27029, 26956, 26883, 26809, 26735, 26660, 26585, 26510, 26434, 26358, 26281, 26204, 26127, 26049, 25970, 25892, 25813, 25733, 25653, 25573, 25492, 25411, 25330, 25248, 25166, 25083, 25000,24917, 24833, 24749, 24665, 24580, 24494, 24409, 24323, 24236, 24149, 24062, 23975, 23887, 23799, 23710, 23621, 23532, 23442, 23352, 23261, 23170, 23079, 22988, 22896, 22804, 22711, 22618, 22525, 22431, 22337, 22243, 22148, 22053, 21958, 21862, 21766, 21670, 21573, 21476, 21379, 21281, 21183, 21085, 20986, 20887, 20788, 20688, 20588, 20488, 20387, 20286, 20185, 20084, 19982, 19880, 19777, 19675, 19572, 19468, 19365, 19261, 19156, 19052, 18947, 18842, 18736, 18631, 18525, 18418, 18312, 18205, 18098, 17990, 17883, 17775, 17666, 17558, 17449, 17340, 17231, 17121, 17011, 16901, 16791, 16680, 16569, 16458, 16347, 16235, 16123, 16011, 15899, 15786,15673, 15560, 15447, 15333, 15219, 15105, 14991, 14876, 14762, 14647, 14531, 14416, 14300, 14184, 14068, 13952, 13835, 13719, 13602, 13485, 13367, 13250, 13132, 13014, 12896, 12777, 12659, 12540, 12421, 12302, 12182, 12063, 11943, 11823, 11703, 11583, 11462, 11342, 11221, 11100, 10979, 10857, 10736, 10614, 10492, 10370, 10248, 10126, 10003, 9881, 9758, 9635, 9512, 9389, 9265, 9142, 9018, 8895, 8771, 8647, 8522, 8398, 8274, 8149, 8024, 7900, 7775, 7650, 7524, 7399, 7274, 7148, 7022, 6897, 6771, 6645, 6519, 6393, 6266, 6140, 6014, 5887, 5760, 5634, 5507, 5380, 5253, 5126, 4999, 4872, 4744, 4617, 4490, 4362, 4235, 4107, 3979, 3851, 3724, 3596, 3468, 3340, 3212, 3084, 2956, 2827, 2699, 2571, 2443, 2314, 2186, 2058, 1929, 1801, 1672, 1544, 1415, 1286, 1158, 1029, 901, 772, 643, 515, 386, 257, 129, 0, -129, -257, -386, -515, -643,-772, -901, -1029, -1158, -1286, -1415, -1544, -1672, -1801, -1929, -2058, -2186, -2314, -2443, -2571, -2699, -2827, -2956, -3084, -3212, -3340, -3468, -3596, -3724, -3851, -3979, -4107, -4235, -4362, -4490, -4617, -4744, -4872, -4999, -5126, -5253, -5380, -5507, -5634, -5760, -5887, -6014, -6140, -6266, -6393, -6519, -6645, -6771, -6897, -7022, -7148, -7274, -7399, -7524, -7650, -7775, -7900, -8024, -8149, -8274, -8398, -8522, -8647, -8771, -8895, -9018, -9142, -9265, -9389, -9512, -9635, -9758, -9881, -10003, -10126, -10248, -10370, -10492, -10614, -10736, -10857, -10979, -11100, -11221, -11342, -11462, -11583, -11703, -11823, -11943, -12063, -12182, -12302, -12421, -12540, -12659, -12777, -12896, -13014, -13132, -13250, -13367, -13485, -13602, -13719, -13835, -13952, -14068, -14184, -14300, -14416, -14531, -14647, -14762,-14876, -14991, -15105, -15219, -15333, -15447, -15560, -15673, -15786, -15899, -16011, -16123, -16235, -16347, -16458, -16569, -16680, -16791, -16901, -17011, -17121, -17231, -17340, -17449, -17558, -17666, -17775, -17883, -17990, -18098, -18205, -18312, -18418, -18525, -18631, -18736, -18842, -18947, -19052, -19156, -19261, -19365, -19468, -19572, -19675, -19777, -19880, -19982, -20084, -20185, -20286, -20387, -20488, -20588, -20688, -20788, -20887, -20986, -21085, -21183, -21281, -21379, -21476, -21573, -21670, -21766, -21862, -21958, -22053, -22148, -22243, -22337, -22431, -22525, -22618, -22711, -22804, -22896, -22988, -23079, -23170, -23261, -23352, -23442, -23532, -23621, -23710, -23799, -23887, -23975, -24062, -24149, -24236,-24323, -24409, -24494, -24580, -24665, -24749, -24833, -24917, -25000, -25083, -25166, -25248, -25330, -25411, -25492, -25573, -25653, -25733, -25813, -25892, -25970, -26049, -26127, -26204, -26281, -26358, -26434, -26510, -26585, -26660, -26735, -26809, -26883, -26956, -27029, -27102, -27174, -27246, -27317, -27388, -27458, -27528, -27598, -27667, -27736, -27804, -27872, -27939, -28006, -28073, -28139, -28205, -28270, -28335, -28399, -28463, -28527, -28590, -28653, -28715, -28777, -28838, -28899, -28959, -29019, -29079, -29138, -29197, -29255, -29312, -29370, -29427, -29483, -29539, -29594, -29649, -29704, -29758, -29812, -29865, -29918, -29970, -30022, -30073, -30124, -30174, -30224, -30274, -30323, -30371, -30419, -30467, -30514,-30561, -30607, -30653, -30698, -30743, -30787, -30831, -30874, -30917, -30959, -31001, -31043, -31084, -31124, -31164, -31204, -31243, -31281, -31319, -31357, -31394, -31431, -31467, -31503, -31538, -31572, -31607, -31640, -31674, -31706, -31739, -31770, -31802, -31832, -31863, -31892, -31922, -31951, -31979, -32007, -32034, -32061, -32087, -32113, -32138, -32163, -32188, -32211, -32235, -32258, -32280, -32302, -32323, -32344, -32365, -32384, -32404, -32423, -32441, -32459, -32476, -32493, -32510, -32525, -32541, -32556, -32570, -32584, -32597, -32610, -32623, -32634, -32646, -32657, -32667, -32677, -32686, -32695, -32703, -32711, -32718, -32725, -32732, -32737, -32743, -32748, -32752, -32756, -32759, -32762, -32764, -32766, -32767,-32768, -32768, -32768, -32767, -32766, -32764, -32762, -32759, -32756, -32752, -32748, -32743, -32737, -32732, -32725, -32718, -32711, -32703, -32695, -32686, -32677, -32667, -32657, -32646, -32634, -32623, -32610, -32597, -32584, -32570, -32556, -32541, -32525, -32510, -32493, -32476, -32459, -32441, -32423, -32404, -32384, -32365, -32344, -32323, -32302, -32280, -32258, -32235, -32211, -32188, -32163, -32138, -32113, -32087, -32061, -32034, -32007, -31979, -31951, -31922, -31892, -31863, -31832, -31802, -31770, -31739, -31706, -31674, -31640, -31607, -31572, -31538, -31503, -31467, -31431, -31394, -31357, -31319, -31281, -31243, -31204, -31164, -31124, -31084, -31043, -31001, -30959, -30917, -30874, -30831, -30787, -30743, -30698,-30653, -30607, -30561, -30514, -30467, -30419, -30371, -30323, -30274, -30224, -30174, -30124, -30073, -30022, -29970, -29918, -29865, -29812, -29758, -29704, -29649, -29594, -29539, -29483, -29427, -29370, -29312, -29255, -29197, -29138, -29079, -29019, -28959, -28899, -28838, -28777, -28715, -28653, -28590, -28527, -28463, -28399, -28335, -28270, -28205, -28139, -28073, -28006, -27939, -27872, -27804, -27736, -27667, -27598, -27528, -27458, -27388, -27317, -27246, -27174, -27102, -27029, -26956, -26883, -26809, -26735, -26660, -26585, -26510, -26434, -26358, -26281, -26204, -26127, -26049, -25970, -25892, -25813, -25733, -25653, -25573, -25492, -25411, -25330, -25248, -25166, -25083, -25000, -24917, -24833, -24749, -24665, -24580,-24494, -24409, -24323, -24236, -24149, -24062, -23975, -23887, -23799, -23710, -23621, -23532, -23442, -23352, -23261, -23170, -23079, -22988, -22896, -22804, -22711, -22618, -22525, -22431, -22337, -22243, -22148, -22053, -21958, -21862, -21766, -21670, -21573, -21476, -21379, -21281, -21183, -21085, -20986, -20887, -20788, -20688, -20588, -20488, -20387, -20286, -20185, -20084, -19982, -19880, -19777, -19675, -19572, -19468, -19365, -19261, -19156, -19052, -18947, -18842, -18736, -18631, -18525, -18418, -18312, -18205, -18098, -17990, -17883, -17775, -17666, -17558, -17449, -17340, -17231, -17121, -17011, -16901, -16791, -16680, -16569, -16458, -16347, -16235, -16123, -16011, -15899, -15786, -15673, -15560, -15447, -15333, -15219,-15105, -14991, -14876, -14762, -14647, -14531, -14416, -14300, -14184, -14068, -13952, -13835, -13719, -13602, -13485, -13367, -13250, -13132, -13014, -12896, -12777, -12659, -12540, -12421, -12302, -12182, -12063, -11943, -11823, -11703, -11583, -11462, -11342, -11221, -11100, -10979, -10857, -10736, -10614, -10492, -10370, -10248, -10126, -10003, -9881, -9758, -9635, -9512, -9389, -9265, -9142, -9018, -8895, -8771, -8647, -8522, -8398, -8274, -8149, -8024, -7900, -7775, -7650, -7524, -7399, -7274, -7148, -7022, -6897, -6771, -6645, -6519, -6393, -6266, -6140, -6014, -5887, -5760, -5634, -5507, -5380, -5253, -5126, -4999, -4872, -4744, -4617, -4490, -4362, -4235, -4107, -3979, -3851, -3724, -3596, -3468, -3340, -3212, -3084, -2956,-2827, -2699, -2571, -2443, -2314, -2186, -2058, -1929, -1801, -1672, -1544, -1415, -1286, -1158, -1029, -901, -772, -643, -515, -386, -257, -129};

//Selecionar codec no mux da mcbsp
void select_codec( void )
{
	//Selecionar canal do codec na MCBSP
	EZDSP5502_I2CGPIO_configLine( BSP_SEL1, OUT );
	EZDSP5502_I2CGPIO_writeLine(  BSP_SEL1, LOW );
	//Habilitar canal do codec na MCBSP
	EZDSP5502_I2CGPIO_configLine( BSP_SEL1_ENn, OUT );
	EZDSP5502_I2CGPIO_writeLine(  BSP_SEL1_ENn, LOW );
}

//O regnum é o número do registrador no codec e regval o valor desejado
Int16 AIC3204_rset( Uint16 regnum, Uint16 regval )
{
    //Array de dois elementos de 16 bits para conter os dados a serem enviados
    Uint16 cmd[2];
    cmd[0] = regnum & 0x007F;       // 7-bit Registrador
    cmd[1] = regval;                // 8-bit Dados
    EZDSP5502_waitusec( 100 );      // Esperar 100 microsegundos
    //Mandar via I2C para ser escrito no registrador do codec
    //Argumento 1 é o endereço I2C, 2 é um array de dados 16 bits, 3 é o tamanho da array
    return EZDSP5502_I2C_write( AIC3204_I2C_ADDR, cmd, 2 );
}

//também é possível ler uma configuração atual de forma similar
Int16 AIC3204_rget(  Uint16 regnum, Uint16* regval )
{
    Int16  retcode = 0;
    Uint16 cmd[2];
    cmd[0] = regnum & 0x007F;       // 7-bit Registrador
    cmd[1] = 0;
    //Informar qual registrador
    retcode |= EZDSP5502_I2C_write( AIC3204_I2C_ADDR, cmd, 1 );
    //Receber valor do registrador
    retcode |= EZDSP5502_I2C_read( AIC3204_I2C_ADDR, cmd, 1 );
    *regval = cmd[0];
    //Esperar 50 microsegundos
    EZDSP5502_waitusec( 50 );
    return retcode;
}

//Exemplo de função para definir configuração do codec
void configure_AIC3204( void )
{
	/* ---------------------------------------------------------------- *
     *  Configure AIC3204                                               *
     * ---------------------------------------------------------------- */
    AIC3204_rset( 0, 0 );      // Select page 0
    AIC3204_rset( 1, 1 );      // Reset codec
    AIC3204_rset( 0, 1 );      // Select page 1
    AIC3204_rset( 1, 8 );      // Disable crude AVDD generation from DVDD
    AIC3204_rset( 2, 1 );      // Enable Analog Blocks, use LDO power
    AIC3204_rset( 0, 0 );
    
    /* PLL and Clocks config and Power Up  */
    AIC3204_rset( 27, 0x0d );  // BCLK and WCLK are set as o/p; AIC3204(Master)
    AIC3204_rset( 28, 0x00 );  // Data ofset = 0
    AIC3204_rset( 4, 3 );      // PLL setting: PLLCLK <- MCLK, CODEC_CLKIN <-PLL CLK
    AIC3204_rset( 6, 7 );      // PLL setting: J=7
    AIC3204_rset( 7, 0x06 );   // PLL setting: HI_BYTE(D=1680)
    AIC3204_rset( 8, 0x90 );   // PLL setting: LO_BYTE(D=1680)
    AIC3204_rset( 30, 0x9C );  // For 32 bit clocks per frame in Master mode ONLY
                               // BCLK=DAC_CLK/N =(12288000/8) = 1.536MHz = 32*fs
    AIC3204_rset( 5, 0x91 );   // PLL setting: Power up PLL, P=1 and R=1
    AIC3204_rset( 13, 0 );     // Hi_Byte(DOSR) for DOSR = 128 decimal or 0x0080 DAC oversamppling
    AIC3204_rset( 14, 0x80 );  // Lo_Byte(DOSR) for DOSR = 128 decimal or 0x0080
    AIC3204_rset( 20, 0x80 );  // AOSR for AOSR = 128 decimal or 0x0080 for decimation filters 1 to 6
    AIC3204_rset( 11, 0x82 );  // Power up NDAC and set NDAC value to 2
    AIC3204_rset( 12, 0x87 );  // Power up MDAC and set MDAC value to 7
    AIC3204_rset( 18, 0x87 );  // Power up NADC and set NADC value to 7
    AIC3204_rset( 19, 0x82 );  // Power up MADC and set MADC value to 2

    /* DAC ROUTING and Power Up */
    AIC3204_rset( 0, 1 );      // Select page 1
    AIC3204_rset( 0x0c, 8 );   // LDAC AFIR routed to HPL
    AIC3204_rset( 0x0d, 8 );   // RDAC AFIR routed to HPR
    AIC3204_rset( 0, 0 );      // Select page 0
    AIC3204_rset( 64, 2 );     // Left vol=right vol
    AIC3204_rset( 65, 0);      // Left DAC gain to 0dB VOL; Right tracks Left
    AIC3204_rset( 63, 0xd4 );  // Power up left,right data paths and set channel
    AIC3204_rset( 0, 1 );      // Select page 1
    AIC3204_rset( 9, 0x30 );   // Power up HPL,HPR
    AIC3204_rset( 0x10, 0x00 );// Unmute HPL , 0dB gain
    AIC3204_rset( 0x11, 0x00 );// Unmute HPR , 0dB gain
    AIC3204_rset( 0, 0 );      // Select page 0
    EZDSP5502_waitusec( 100 ); // wait
        
    /* ADC ROUTING and Power Up */
    AIC3204_rset( 0, 1 );      // Select page 1
    AIC3204_rset( 0x34, 0x30 );// STEREO 1 Jack
                               // IN2_L to LADC_P through 40 kohm
    AIC3204_rset( 0x37, 0x30 );// IN2_R to RADC_P through 40 kohmm
    AIC3204_rset( 0x36, 3 );   // CM_1 (common mode) to LADC_M through 40 kohm
    AIC3204_rset( 0x39, 0xc0 );// CM_1 (common mode) to RADC_M through 40 kohm
    AIC3204_rset( 0x3b, 0 );   // MIC_PGA_L unmute
    AIC3204_rset( 0x3c, 0 );   // MIC_PGA_R unmute
    AIC3204_rset( 0, 0 );      // Select page 0
    AIC3204_rset( 0x51, 0xc0 );// Powerup Left and Right ADC
    AIC3204_rset( 0x52, 0 );   // Unmute Left and Right ADC
    AIC3204_rset( 0, 0 );    
    EZDSP5502_waitusec( 200 ); // Wait
}

void main( void )
{
	Int16 songPtr = 0;
	Int16 freq10 = song[0];
	Int16 i = 0;
	Int16 sample = 0;
	Int16 freq = 80;
	Int16 sample2 = 0;
	
    //Inicializar BSL
    EZDSP5502_init( );
    
    //Selecionar codec
    select_codec();
    
    //Configurar codec
    configure_AIC3204();
    
    //Configurar push buttons
    EZDSP5502_I2CGPIO_configLine(  SW0, IN );
    EZDSP5502_I2CGPIO_configLine(  SW1, IN );
    
    //Iniciar funcionamento da MCBSP
    EZDSP5502_MCBSP_init( );
    
    while(1)
    {
    	//Esse botao toca música
    	if(!EZDSP5502_I2CGPIO_readLine(SW0))
    	{
    		songPtr = 0;
    		while(songPtr < 60)
		    {
		    	freq10 = song[songPtr];
		    	for(i = 0; i < freq10*4; i++)
		    	{
			    	EZDSP5502_MCBSP_write(32767);
				    EZDSP5502_MCBSP_write(32767);
				    EZDSP5502_waitusec(50000/freq10);
				    EZDSP5502_MCBSP_write(-32767);
				    EZDSP5502_MCBSP_write(-32767);
				    EZDSP5502_waitusec(50000/freq10);
		    	}
		    	songPtr++;
		    }
    	}
    	//Esse botao inicia alarme
	    else if(!EZDSP5502_I2CGPIO_readLine(SW1))
	    {
		    freq = 80;
		    for(i = 0; i < 200; i++)
		    {
		    	if(freq > 280) freq = 80;
		    	for(sample = 0; sample < 5000; sample++)
		    	{
			    	EZDSP5502_MCBSP_write(sinetable[sample2] );      // TX left channel first (FS Low)
			        EZDSP5502_MCBSP_write(sinetable[sample2] );      // TX right channel next (FS High)
			        sample2 += freq;
			        if(sample2 > TABLESIZE-1) sample2 = sample2 - TABLESIZE;
			    }
			    freq += 10;
		    }
	    }
	    
    }
    
    EZDSP5502_MCBSP_close(); // Desabilitar McBSP
}
